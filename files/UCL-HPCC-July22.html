<!doctype html>
<html lang="en">
<head>
<title>UCL-HPCC-July22</title>
<meta name="generator" content="Etherpad">
<meta name="author" content="Etherpad">
<meta name="changedby" content="Etherpad">
<meta charset="utf-8">
<style>
ol {
  counter-reset: item;
}

ol > li {
  counter-increment: item;
}

ol ol > li {
  display: block;
}

ol > li {
  display: block;
}

ol > li:before {
  content: counters(item, ".") ". ";
}

ol ol > li:before {
  content: counters(item, ".") ". ";
  margin-left: -20px;
}

ul.indent {
  list-style-type: none;
}

h1{font-size: 2.5em;}
h2{font-size: 1.8em;}
h3{font-size: 1.5em;}
h4{font-size: 1.2em;}
code{font-family: RobotoMono;}

</style>
</head>
<body>
Welcome to The Carpentries Etherpad!<br><br>This pad is synchronized as you type, so that everyone viewing this page sees the same text. This allows you to collaborate seamlessly on documents.<br><br>Use of this service is restricted to members of The Carpentries community; this is not for general purpose use (for that, try <a href="https&#x3a;&#x2F;&#x2F;etherpad&#x2e;wikimedia&#x2e;org" rel="noreferrer noopener">https:&#x2F;&#x2F;etherpad.wikimedia.org</a>).<br><br>Users are expected to follow our code of conduct: <a href="https&#x3a;&#x2F;&#x2F;docs&#x2e;carpentries&#x2e;org&#x2F;topic&#x5f;folders&#x2F;policies&#x2F;code&#x2d;of&#x2d;conduct&#x2e;html" rel="noreferrer noopener">https:&#x2F;&#x2F;docs.carpentries.org&#x2F;topic_folders&#x2F;policies&#x2F;code-of-conduct.html</a><br><br>All content is publicly available under the Creative Commons Attribution License: <a href="https&#x3a;&#x2F;&#x2F;creativecommons&#x2e;org&#x2F;licenses&#x2F;by&#x2F;4&#x2e;0&#x2F;" rel="noreferrer noopener">https:&#x2F;&#x2F;creativecommons.org&#x2F;licenses&#x2F;by&#x2F;4.0&#x2F;</a><br><br>&nbsp;----------------------------------------------------------------------------<br>&nbsp;<br>&nbsp;<br><h1>Using this Etherpad</h1><br>If you want to add to this document, just click anywhere and start typing! You can use the buttons at the top left to make things <strong>bold</strong>, <em>italic</em> <u>etc.</u><br><ul class="bullet"><li>or</li><li>make</li><li>lists...</ul><br><code>You can also add bits of code...</code><br>... by clicking the drop down menu that says &quot;Normal&quot;.<br><br>You can add your name to the Users on the top right and click the &quot;Settings&quot; wheel symbol at the top right to change the font, show a table of contents, show or hide line numbers and authorship colours or show the chat.<br><br><h2>During the course</h2><br>We will use this document to introduce ourselvels and keep some notes throughout the course.<br>You can ask questions here or in Zoom, the helpers will try to answer and help with any problems.<br><br><h1>Setup</h1><br><ol start="1" class="number"><li><strong>Pre-workshop survey </strong>- please complete this short survey to help us design the workshop to work for you: <a href="https&#x3a;&#x2F;&#x2F;carpentries&#x2e;typeform&#x2e;com&#x2F;to&#x2F;wi32rS&#x3f;slug&#x3d;2022&#x2d;07&#x2d;26&#x2d;UCL&#x2d;HPC&#x2d;online" rel="noreferrer noopener">https:&#x2F;&#x2F;carpentries.typeform.com&#x2F;to&#x2F;wi32rS?slug=2022-07-26-UCL-HPC-online</a></li><li><strong>Please read The Carpentries Code of Conduct</strong> so that we all are aware of how to treat each other respectfully: <a href="https&#x3a;&#x2F;&#x2F;docs&#x2e;carpentries&#x2e;org&#x2F;topic&#x5f;folders&#x2F;policies&#x2F;code&#x2d;of&#x2d;conduct&#x2e;html" rel="noreferrer noopener">https:&#x2F;&#x2F;docs.carpentries.org&#x2F;topic_folders&#x2F;policies&#x2F;code-of-conduct.html</a></li><li><strong>Research Computing account</strong> - please fill in the form and note that students will need approval of their supervisor, so please remind your supervisor to look out for an email and complere the request: <a href="https&#x3a;&#x2F;&#x2F;www&#x2e;rc&#x2e;ucl&#x2e;ac&#x2e;uk&#x2F;docs&#x2F;Account&#x5f;Services&#x2F;" rel="noreferrer noopener">https:&#x2F;&#x2F;www.rc.ucl.ac.uk&#x2F;docs&#x2F;Account_Services&#x2F;</a></li><li><strong>Setup </strong>- Follow the instructions on the course webpage <a href="https&#x3a;&#x2F;&#x2F;ucl&#x2d;arc&#x2e;github&#x2e;io&#x2F;2022&#x2d;07&#x2d;26&#x2d;UCL&#x2d;HPC&#x2d;online&#x2F;" rel="noreferrer noopener">https:&#x2F;&#x2F;ucl-arc.github.io&#x2F;2022-07-26-UCL-HPC-online&#x2F;</a></ol><br><br><h1>Links</h1><br><ul class="bullet"><li>Main course webpage: <a href="https&#x3a;&#x2F;&#x2F;ucl&#x2d;arc&#x2e;github&#x2e;io&#x2F;2022&#x2d;07&#x2d;26&#x2d;UCL&#x2d;HPC&#x2d;online&#x2F;" rel="noreferrer noopener">https:&#x2F;&#x2F;ucl-arc.github.io&#x2F;2022-07-26-UCL-HPC-online&#x2F;</a></li><li>Zoom link to access the course: <a href="https&#x3a;&#x2F;&#x2F;ucl&#x2e;zoom&#x2e;us&#x2F;j&#x2F;95033169821" rel="noreferrer noopener">https:&#x2F;&#x2F;ucl.zoom.us&#x2F;j&#x2F;95033169821</a>&nbsp;</li><li>Code of conduct: <a href="https&#x3a;&#x2F;&#x2F;docs&#x2e;carpentries&#x2e;org&#x2F;topic&#x5f;folders&#x2F;policies&#x2F;code&#x2d;of&#x2d;conduct&#x2e;html" rel="noreferrer noopener">https:&#x2F;&#x2F;docs.carpentries.org&#x2F;topic_folders&#x2F;policies&#x2F;code-of-conduct.html</a></li><li>More information on Research Computing at UCL, including Thomas and Myriad: <a href="https&#x3a;&#x2F;&#x2F;www&#x2e;rc&#x2e;ucl&#x2e;ac&#x2e;uk&#x2F;docs&#x2F;" rel="noreferrer noopener">https:&#x2F;&#x2F;www.rc.ucl.ac.uk&#x2F;docs&#x2F;</a></li><li>Other training opportunities: <a href="https&#x3a;&#x2F;&#x2F;www&#x2e;ucl&#x2e;ac&#x2e;uk&#x2F;isd&#x2F;services&#x2F;research&#x2d;it&#x2F;research&#x2d;it&#x2d;training" rel="noreferrer noopener">https:&#x2F;&#x2F;www.ucl.ac.uk&#x2F;isd&#x2F;services&#x2F;research-it&#x2F;research-it-training</a></li><li>Join the Research Programming Hub: <a href="https&#x3a;&#x2F;&#x2F;www&#x2e;ucl&#x2e;ac&#x2e;uk&#x2F;research&#x2d;it&#x2d;services&#x2F;ucl&#x2d;research&#x2d;programming&#x2d;hub" rel="noreferrer noopener">https:&#x2F;&#x2F;www.ucl.ac.uk&#x2F;research-it-services&#x2F;ucl-research-programming-hub</a> You can join mailing lists and the Slack workspace where you can discuss programming with others across the University, get help with your code and hear about new training opportunities.</li><li>Advanced Research Computing drop in sessions for 1:1 support: <a href="https&#x3a;&#x2F;&#x2F;www&#x2e;ucl&#x2e;ac&#x2e;uk&#x2F;advanced&#x2d;research&#x2d;computing&#x2F;support" rel="noreferrer noopener">https:&#x2F;&#x2F;www.ucl.ac.uk&#x2F;advanced-research-computing&#x2F;support</a></ul><br><ul class="bullet"><li>If you want advice later on how to run your code on the UCL HPC systems pelase contact rc-support@ucl.ac.uk</ul><br><br><h1>Day 1 - Tuesday 26th July</h1><br><strong>Instructor:</strong> Tom Couch<br><strong>Helpers: </strong>Sarah Jaffa, David Wong<br><br><h2>Schedule</h2><br><ul class="indent"><li>09:30&nbsp; (Optional) Help with setup issues&nbsp;&nbsp;</li><li>10:00&nbsp; Introduction</li><li>10:30&nbsp; Teaching - The Unix Shell</li><li>13:00&nbsp; End of day</ul><br><h2>Introductions</h2><br><br>Please add your name, what department you work in and how you hope to use HPC in your work<br><br><ol start="1" class="number"><li>&nbsp;Sarah Jaffa, Advanced Research Computing - I am working on optimising C++ code using machine learning to remove noise from astronomical images for the next generation of supercomputers.</li><li>&nbsp;Jeremy Saxe, UCL MRC CTU, I work on simulations of clinical trial data analysis&nbsp;</li><li>&nbsp; Yiming Yang, UCL Department of Statistical Sceince, I work on simulations of tokamak nuclear fusion with uncertainty qualification and sensitivity analysis.</li><li>&nbsp;Tom Couch, Advanced Research Computing - I mostly work on developing web apps to support research</li><li>&nbsp;Declan Cooper, Geography &#x2F; Center for Biodiversity and Environment Research - data analysis and modelling of tropical tree species distributions</li><li>&nbsp;Idil Ozdemir, UCL Advanced Research Computing. I am currently working on improving bioimage analysis pipelines for disease tracking and machine learning models for text classification</li><li>&nbsp;Guokai Chen, UCL BSEER, Institute of Environmental Design and Engineering - I work on building simulations on control-oriented models and hopefully HPC could speed up my simulations.</li><li>&nbsp; Jingyi Xuan, UCL MRC CTU, I work on statistical methods to handle treatment switching in RCTs.</li><li>&nbsp;David Wong, Digital Education and Advanced Research Computing, no particular project using HPC, helping with training</li><li>&nbsp;Nico Hernandez, @StatSci, UCL. Basic HPC expreience @Cambridge, using SLURM. Parallelize Monte Carlo experiments, using arrays, pass arguments to R script&nbsp;</li><li>&nbsp;Heather Kelly, UCL Research Computing. I support Myriad and the other central HPC clusters here at UCL.&nbsp;</ol><br><br><br><h2>Notes</h2><br>Setup:<br>Download shell-lesson-data.zip: <a href="https&#x3a;&#x2F;&#x2F;swcarpentry&#x2e;github&#x2e;io&#x2F;shell&#x2d;novice&#x2F;data&#x2F;shell&#x2d;lesson&#x2d;data&#x2e;zip" rel="noreferrer noopener">https:&#x2F;&#x2F;swcarpentry.github.io&#x2F;shell-novice&#x2F;data&#x2F;shell-lesson-data.zip</a><br><br>Commands:<br><ul class="bullet"><li><strong>clear </strong>- empty the terminal</li><li><strong>ls</strong> - list the files and folders in the current folder<ul class="bullet"><li>ls -a - list all the files and folders including hidden ones (start with a .)</li><li>ls -l - long list (gives more details such as date created, size, owner)</li><li>ls -F - displays directories with a trailing &#x2F;</ul><li><strong>pwd</strong> - show where the present working directory is located</li><li><strong>man </strong>- short for manual, displays help text for any command<ul class="bullet"><li>man &lt;command&gt; - show help for a particular command (e.g. &#x27;man ls&#x27; to show help for ls)</ul><li>Pager (the window that shows lots of text, like the man pages) has several commands to move about:<ul class="bullet"><li>f - move a page forwards</li><li>b - move a page backwards</li><li>&#x2F; - search for a particular word<ul class="bullet"><li>n to go to the next instrance of your search</li><li>N to go to the previous instance of your search</ul><li>q to quit the pager</ul><li><strong>cd</strong> - change directory (move to a different folder)<ul class="bullet"><li>cd&nbsp;&nbsp;&nbsp;&nbsp; (cd with no extra arguments) go to the home directory</li><li>cd ~ - go to the home directory</li><li>cd - (cd then the minus symbol) - go to the directory you were in before</li><li>cd .. - go to the parent folder of your current folder</ul><li><strong>mkdir</strong> - create a new directory<ul class="bullet"><li>mkdir folder-of-stuff - makes a new folder called &quot;folder-of-stuff&quot; (tip: don&#x27;t use spaces)</ul><li><strong>nano </strong>- Opens nano, like notepad for the command line (good for simple text edits)<ul class="bullet"><li>If you get an error saying &#x27;command not found&#x27; , enter &#x27;module load nano&#x27; then try again</li><li>&quot;^C&quot; means CTRL+C. Likewise for other &quot;^[key]&quot; options CTRL+[key].&nbsp;</li><li>&quot;M-B&quot; means ALT+B. Likewise for other &quot;M-[key]&quot; options being ALT+[key]</li><li>To open a file that already exisits use &#x27;nano &lt;filename&gt;&#x27;</ul><li><strong>cat &lt;textfile&gt;</strong> - show the contents of a text file (short for concatenate)</li><li><strong>mv &lt;oldfile&gt; &lt;newfile&gt;</strong> - moves or renames a file<ul class="bullet"><li>To keep the exisitng name you can use &quot;mv &lt;oldfile&gt; &lt;newdirectory&gt;&quot; to keep the same name but change the location to &lt;newdirectory&gt;</ul><li><strong>cp &lt;currentfile&gt; &lt;copyfile&gt;</strong> - makes a copy of &lt;currentfile&gt; called &lt;copyfile&gt;</li><li><strong>rm &lt;file&gt; </strong>- delete (remove) a file (BE CAREFUL as there is no recycle bin, you cannot get this back)<ul class="bullet"><li>rm -r - recursive delete (delete a directory and delete everything inside it including other directories and things inside them)</li><li>rm -v - verbose means return the names of the things being deleted</ul><li><strong>rmdir &lt;directory&gt;</strong> - delete (remove) an empty folder (directory)</li><li><strong>touch &lt;filename&gt;</strong> - create empty file with the given filename</li><li><strong>Wildcards: </strong>* matches 0 or more characters, ? matches exactly one character</li><li><strong>history</strong> - show a liist of the commands you have typed recently<ul class="bullet"><li><strong>!&lt;number&gt;</strong> repeats the numbered command from your history</ul><li><strong>head -n 15</strong>:&nbsp; Print the first 15 lines of a text file (for example). If the option is omitted, it shows the first 10 lines by default</li><li><strong>tail -n 12</strong>:&nbsp; Print the last 12 lines of a text file (for example). If the option is omitted, it shows the last 10 lines by default</li><li><strong>wc &lt;file&gt;</strong>: Count the lines or words in a file. By default is counts words, you can use the -l option to count lines.</li><li>stdout and stderr are the two streams to which the commands can write their output</li><li>stdout is the standard output stream, which is usually the console (screen). Content on the standard output can be redirected to a file by using the `&gt;` operator e.g.&nbsp; command&nbsp; &gt; filename. This will destructively replace the existing content in the file</li><li>stderr is the standard error stream. This is also usually the console (screen), but can be redirected&nbsp; to a separate file by using `2&gt;`&nbsp; e.g. command 2&gt; errorfile.txt</li><li>You can append to existing content by using the &gt;&gt; operator e.g. command &gt;&gt; file_to_overwrite.txt</li><li>The output and error streams can be combined by using the &amp;&gt; operator e.g. command &amp;&gt; file_with_errors_and_outputs.txt</li><li>stdin is the name of the standard input stream (usually represents characters from either the keyboard or&nbsp; read in from a file)</li><li>vertical line charachter <strong>|</strong> (called a pipe) is used to pass the output of the left-hand side command as an input to&nbsp; the right-hand side command, e.g. grep author paper.txt <strong>|</strong> wc -l</li><li>a script is a file with a collection of commands that are executed in order.</li><li>The first line in a script shows the program that will run the script, here we use bash so the appropriate line is <strong>#!&#x2F;bin&#x2F;bash</strong></li><li>To execute a script, the user (owner of the script) needs to have permission to execute it</li><li>To check permissions for the user, group and everyone else, type<strong> ls -l</strong></li><li>In a script, variables are defined as: <strong>variable_name</strong>=<strong>value</strong>, with no spaces around the&nbsp; <strong>=</strong> sign</li><li>Variables are used as <strong>$variable_name</strong>,<strong> </strong>note the $ sign in front of the variable&#x27;s name</li><li>A script can take input from the user. Inside the script, the 1st input argument is used as $1, the 2nd as $2, etc&nbsp;</li><li><strong>#</strong> - starts a comment line in Bash</li><li>Scripts may also contain loops. to iterate over a list of things:<ul class="bullet"><li><ul class="bullet"><li><strong>for</strong> VAR <strong>in</strong> first second third &quot;fourth and fifth&quot;&nbsp;</li><li><strong>do</strong></li><li>&lt;stuff to do&gt;</li><li><strong>done</strong>....&nbsp;&nbsp;</ul><li>the list of things is separated by a space</li><li>quotes are needed if an entity in the list contains spaces itself</ul></li></ul><br><br><h4>Tips:</h4><br><ul class="bullet"><li>Tab key will autocomplete commands, file names etc.</li><li>Man pages (manual) are long and can be hard to read. If you are using the Bash shell a lot you might want to install a new command tldr which gives shorter less detailed hepl text (<a href="https&#x3a;&#x2F;&#x2F;github&#x2e;com&#x2F;tldr&#x2d;pages&#x2F;tldr" rel="noreferrer noopener">https:&#x2F;&#x2F;github.com&#x2F;tldr-pages&#x2F;tldr</a>)</li><li>If you get stuck in a command or screen you don&#x27;t want to be in, try pressing q or Ctrl-C (Cmd-C on mac)</li><li>Up arrow shows the last command you entered (and you can keep going as far back as you like)</li><li>Most (but not all) commands have an option --help that will give a shorter help text than the man pages.</li><li>For a more advanced way of listing files and folders, have a look at the command &#x27;tree&#x27; <a href="https&#x3a;&#x2F;&#x2F;www&#x2e;tecmint&#x2e;com&#x2F;linux&#x2d;tree&#x2d;command&#x2d;examples&#x2F;" rel="noreferrer noopener">https:&#x2F;&#x2F;www.tecmint.com&#x2F;linux-tree-command-examples&#x2F;</a></li><li>File extensions (the bit after the dot) are not really important in the Bash shell. The give you a clue what find of file it is (.txt is probably text, .doc is probably a word file, .png is probably a picture) but in the shell you will choose how to read or open the file yourself. This is different on Windows and Mac where the extension tells the computer wehat program to open it with - if you click on a file called .png the computer will try to open it as a picture, whether it is really a picture or not.</li><li>There are shortcuts to reference multiple files in commands once you get more comfortable. To reference files with sequential numbers, you can use {#..#}, e.g. &quot;touch file{1..4}.txt&quot; creates file1.txt, file2.txt, etc. Similarly, * allows for &quot;anything&quot; e.g. &quot;cp *.txt ~&#x2F;&quot; will copy all files ending in .txt to the ~&#x2F; directory. These can be combined e.g. &quot;rm test{3..5}*&quot; will remove all files starting with test3, test4 or test5; files such as test3.png, test3final.docx or test5second.txt would be removed but files such as test1.txt or tester5.txt would not be removed.</li><li><strong>echo &lt;something&gt; </strong>: echo means to return whatever you give it, so it prints back whatever you put as the argument</ul><br><ul class="bullet"><li>The list of things to loop over can be obtained using wildcards, for example, to iterate&nbsp; over all txt files in the current directory:&nbsp;<ul class="bullet"><li><strong>for</strong> VAR <strong>in</strong> *.txt</ul><li>Curly brackets {...} are a useful way to use a variable name to avoid any ambiguities<ul class="bullet"><li>suppose that you have variables <strong>FILE</strong> and <strong>FILE_processed</strong> and you would like to append &quot;_processed&quot; to the FILE variable</li><li>echo <strong>${FILE}_processed</strong>, adds the &quot;_processed&quot; to the variable <strong>FILE</strong></li><li>echo <strong>$FILE_processed</strong> refers to the already existing variable</ul><li>Commands often take the format &quot;command [options] [arguments]&quot;<ul class="bullet"><li>e.g. command ls to list files, option -a to ask for &quot;all&quot;, argument ~ to mean home<ul class="bullet"><li>ls -a ~</ul><li>You can use many options together like this:<ul class="bullet"><li>ls -a -l is the same as</li><li>ls -l -a (order doesn&#x27;t matter) is the same as</li><li>ls -al (combine the options together)</ul></li></ul></li></ul><br><br><br><br><h3>Questions</h3><br>Please add any questions or comments here<br><br><ul class="bullet"><li>&nbsp;</li><li>&nbsp;</li></ul><br><br><br><br><h2>Feedback from day 1</h2><br>Please give us some feedback here:<br><a href="https&#x3a;&#x2F;&#x2F;ideaboardz&#x2e;com&#x2F;for&#x2F;uclhpcc&#x2d;july22&#x2F;4575438" rel="noreferrer noopener">https:&#x2F;&#x2F;ideaboardz.com&#x2F;for&#x2F;uclhpcc-july22&#x2F;4575438</a><br><br>Please let us know&nbsp;<br><ul class="bullet"><li>something that went well today (maybe something you learned that will be very useful to your work)</li><li>something we can improve (maybe something that you found made it more difficult for you to learn, or a command where you got stuck or confused)</ul><br>Press the green plus symbol to add a new note or click on a note to add a +1 to someone else&#x27;s comment.<br><br><h1>Day 2 - Wednesday 27th July</h1><br><strong>Instructor:</strong> Sarah Jaffa<br><strong>Helpers: </strong>Heather Kelly<br><br><h2>Schedule</h2><br><ul class="indent"><li>09:30&nbsp; (Optional) Help with issues from day 1</li><li>10:00&nbsp; Teaching - Introduction to HPC</li><li>13:00&nbsp; End of day</ul><br><br><h2>Notes</h2><br><ul class="bullet"><li>Creating an ssh key:</ul><code>ssh-keygen <strong>-a</strong> 100 <strong>-f</strong> ~&#x2F;.ssh&#x2F;id_ed25519 <strong>-t</strong> ed25519</code><br><ul class="bullet"><li><code>-a (default is 16): number of rounds of passphrase derivation; increase to slow down brute force attacks.</code></li><li><code>-t (default is rsa): specify the &#8220;type&#8221; or cryptographic algorithm. ed25519 specifies EdDSA with a 256-bit key; it is faster than RSA with a comparable strength.</code></li><li><code>-f (default is &#x2F;home&#x2F;user&#x2F;.ssh&#x2F;id_algorithm): filename to store your private key. The public key filename will be identical, with a .pub extension added.</code></li><li>scp: copy the <strong>public </strong>key from your computer to your home directory on the ssh gateway. (The private key must be kept secure and never shared or emailed).<ul class="bullet"><li>scp &#x2F;home&#x2F;username&#x2F;.ssh&#x2F;id_ed25519.pub username@ssh-gateway.ucl.ac.uk:~</li><li>If you ssh in and the key isn&#x27;t there, check the other ejp-gateway machine - there is ejp-gateway01.ad.ucl.ac.uk and ejp-gateway02.ad.ucl.ac.uk. You can ssh from one to the other.</ul><li>Add the contents of the .pub file as one line to your ~&#x2F;.ssh&#x2F;authorized_keys file by appending it. Do this on both ejp gateway machines and on Myriad.<ul class="bullet"><li>cat id_ed25519.pub &gt;&gt; ~&#x2F;.ssh&#x2F;authorized_keys</ul><li>Changing permissions on .ssh folders: chmod go-rwx ~&#x2F;.ssh</li><li>#!&#x2F;bin&#x2F;bash -l</ul><br><br><ul class="bullet"><li><strong>qhost</strong> : lists the nodes available on the system you are using</li><li><strong>nodetypes:</strong> a summary of all nodes available in the cluster, grouped by type.</li><li><strong>If you are outside the UCL network</strong> (not physically on site) you will need to get onto the network before accessing Myriad. You can log into ssh-gateway from outside the network then access Myriad from there. See Research Computing documentation for more info: <a href="https&#x3a;&#x2F;&#x2F;www&#x2e;rc&#x2e;ucl&#x2e;ac&#x2e;uk&#x2F;docs&#x2F;" rel="noreferrer noopener">https:&#x2F;&#x2F;www.rc.ucl.ac.uk&#x2F;docs&#x2F;</a></li><li>The scheduler organises which jobs run on which nodes (Like a head waiter at a restaurant). Most scheduler commands begin with the letter q</li><li>Priority of allocating nodes might be given to a larger job before a smaller one (as otherwise the larger job would wait forever for enough nodes); it&#x27;s not first-come-first-serve. Similarly, shorter requested time (see h_rt) will speed up job allocation!</li><li>The queue system used is &quot;Sun Grid Engine&quot;</li><li>The first line in a job script shows the program that will run the script and that we want the &#x27;login&#x27; environment on Myriad: <strong>#!&#x2F;bin&#x2F;bash -l or #!&#x2F;bin&#x2F;bash --login</strong></li><li><strong>qsub</strong> : To submit a job script (Bash script with instructions for your job) to the scheduler</li><li><strong>qstat</strong> : Check the status of your job on the scheduler. This will tell you the job name and whether it is in the queue, running, or finished</li><li><strong>qdel &lt;jobnumber&gt;</strong> : Delete a job from the queue (e.g. made by mistake, in eqw state)<ul class="bullet"><li>This works on jobs whether they have started to run or not</li><li>You can delete all jobs you have submitted using: qdel -u &lt;yourusername&gt; &#x27;*&#x27;</ul><li><strong>qexplain &lt;jobnumber&gt;</strong> : more detailed information on a job, useful if job failed</li><li><strong>qrsh &lt;options&gt;</strong> : Run an &quot;interactive&quot; node session (you can type commands and respond to prompts directly)<ul class="bullet"><li>May require use of &quot;-now no&quot; option, which tells it to wait as long as it takes to get a free session</ul><li><strong>watch</strong> : repeat a command to update hte output if you want to see when it changes.<ul class="bullet"><li>watch -n 15 qstat : run the qstat command every 15 seconds to update the output so you can see when it runs. Don&#x27;t use this often as it uses a lot of resources.</ul><li><strong>jobhist</strong> : Shows a history of run jobs, including start and end time, node used and exit code</li><li>Output will be sent to two files called &lt;jobscriptname&gt;.e&lt;jobnumber&gt; for the stderr (standard error) stream, where all warnings and errors will go, and &lt;jobscriptname&gt;.o&lt;jobnumber&gt; for the stdout (standard output) stream, where the output of your code will go.<ul class="bullet"><li>We talked yesterday about redirecting stdout and stderr using &gt; or &amp;&gt;, so inside your script you can send these to a different file</ul><li>Anything in your Bash script starting with a # will be seen as a comment, so Bash will not run these lines <strong>but</strong> job scripts are special... If a line starts with #$ Bash will ignore it as a comment, but the <strong>scheduler</strong> will find it and read it as an instruction about scheduling. More details on these is available here: <a href="https&#x3a;&#x2F;&#x2F;www&#x2e;rc&#x2e;ucl&#x2e;ac&#x2e;uk&#x2F;docs&#x2F;Experienced&#x5f;Users&#x2F;&#x23;script&#x2d;sections" rel="noreferrer noopener">https:&#x2F;&#x2F;www.rc.ucl.ac.uk&#x2F;docs&#x2F;Experienced_Users&#x2F;#script-sections</a><ul class="bullet"><li>#$ -N &lt;script_name&gt; : adding this line at the start of your script will give your job that name within the queue system&nbsp;</li><li>#$ -m abe : send an email when the job (b)egins, (a)borts or (e)nds</li><li>#$ -M &lt;email@email.com&gt; : The address to send the messages to.</li><li>#$ -pe smp # : request a number of cores for the job</li><li>#$ -l &lt;option&gt; : &quot;limit&quot; resource specified<ul class="bullet"><li>mem=#G : limit to this much memory per-core</li><li>h_rt=hh:mm:ss : limit runtime to be upto the specified (h)ours,(m)ins, (s)econds</ul><li>#$ -wd &lt;dir&gt; : changes &quot;working directory&quot; to the given directory (where to run)</li><li>#$ gpu=1 : request one GPU</ul><li>There are some example jobscripts for different types of jobs here: <a href="https&#x3a;&#x2F;&#x2F;www&#x2e;rc&#x2e;ucl&#x2e;ac&#x2e;uk&#x2F;docs&#x2F;Example&#x5f;Jobscripts" rel="noreferrer noopener">https:&#x2F;&#x2F;www.rc.ucl.ac.uk&#x2F;docs&#x2F;Example_Jobscripts</a> A good way to start is to copy one of theses and edit it to fit your needs.</li><li>scriptfor &lt;jobnumber&gt; shows the script that was submitted for a particular job number (even if you have since changed or deleted the file)</li><li>lustre is the name of the place where the home directory is stored. If you see a working directory like &#x27;&#x2F;lustre&#x2F;home&#x2F;your_username&#x27; that is the same place we previously looked at &#x27;&#x2F;home&#x2F;your_username&#x27;.</li><li>There are alternative systems to Myriad, if you have data security or other requirements Myriad cannot be used for (tbd). Info on the different clusters available within UCL is here: <a href="https&#x3a;&#x2F;&#x2F;www&#x2e;rc&#x2e;ucl&#x2e;ac&#x2e;uk&#x2F;docs&#x2F;" rel="noreferrer noopener">https:&#x2F;&#x2F;www.rc.ucl.ac.uk&#x2F;docs&#x2F;</a></li><li><strong>module list</strong> : show the software currently available in your environment.<ul class="bullet"><li><strong>module avail</strong> : show the software that is isntalled on Myriad that you can add to your environment if you want it.</li><li><strong>module load &lt;software&gt;&#x2F;&lt;version&gt;</strong> : load a bit of availble software into your environment, a specific version is optional<ul class="bullet"><li><strong>module load default-modules</strong> : load the modules that are the default ones loaded when you log in.</ul><li><strong>module unload &lt;software&gt; </strong>: remove a bit of software from your environment</li><li><strong>module show &lt;software&gt; </strong>: show more details of what will be laoded with a particular bit of software, including what is inside a bundle</li><li><strong>module purge</strong> : remove all loaded modules in the environment</ul><li>If you want a module to always be loaded when a job is run, you can add the &quot;module load &lt;software&gt;&quot; command to the end of the file at &quot;~&#x2F;.bashrc&quot;; this is useful if you want some modules always loaded, but be aware if this file runs every time you start a job!</ul><br><h3>Questions and comments</h3><br>Please add any questions or comments here<br><br><ul class="bullet"><li>&nbsp;</li><li>&nbsp;</li></ul><br><h2>Feedback from day 2</h2><br>Please give us some feedback here:<br><a href="https&#x3a;&#x2F;&#x2F;ideaboardz&#x2e;com&#x2F;for&#x2F;uclhpcc&#x2d;july22&#x2F;4575438" rel="noreferrer noopener">https:&#x2F;&#x2F;ideaboardz.com&#x2F;for&#x2F;uclhpcc-july22&#x2F;4575438</a><br><br>Please let us know&nbsp;<br><ul class="bullet"><li>something that went well today (maybe something you learned that will be very useful to your work)</li><li>something we can improve (maybe something that you found made it more difficult for you to learn, or a command where you got stuck or confused)</ul><br>Press the green plus symbol to add a new note or click on a note to add a +1 to someone else&#x27;s comment.<br><br><h1>Day 3 - Thursday 28th July</h1><br><strong>Instructor:</strong> Heather Kelly<br><strong>Helpers: </strong>Sarah Jaffa, Brian Alston<br><h2>Schedule</h2><br><ul class="indent"><li>09:30&nbsp; (Optional) Help with issues from day 2&nbsp;</li><li>10:00&nbsp; Introduction to High-Performance Computing (Continued)&nbsp;&nbsp;</li><li>13:00&nbsp; Lunch break&nbsp;&nbsp;</li><li>14:00&nbsp; Hands-on exercise&nbsp;&nbsp;</li><li>16:30&nbsp; Wrap-up&nbsp;&nbsp;</li><li>16:45&nbsp; Post-workshop Survey&nbsp;</li><li>17:00&nbsp; END</li></ul><h2>Notes</h2><br><ul class="bullet"><li><code>wget <a href="http&#x3a;&#x2F;&#x2F;rits&#x2e;github&#x2d;pages&#x2e;ucl&#x2e;ac&#x2e;uk&#x2F;hpc&#x2d;intro&#x2F;files&#x2F;hpc&#x2d;intro&#x2d;data&#x2e;tar&#x2e;gz" rel="noreferrer noopener">http:&#x2F;&#x2F;rits.github-pages.ucl.ac.uk&#x2F;hpc-intro&#x2F;files&#x2F;hpc-intro-data.tar.gz</a></code></li><li><strong>scp</strong> : &#x27;secure copy&#x27; to send files to the HPC and back over the SSH connection (you should run this from your own machine, not logged into Myriad)<ul class="bullet"><li>scp &lt;path to file now&gt; username@remotemachine.address:&lt;location-of-copied-file&gt;</li><li>For example to copy the file thing.txt from your current directory to your home directory on Myriad (where cceasja should be replaced with your username):<ul class="bullet"><li>scp .&#x2F;thing.txt ccaesja@myriad.rc.ucl.ac.uk:~</ul><li>The colon : separating the address of Myriad from the location where you want the file to go can be hard to spot, so be careful with that bit</li><li>To go from your computer to ssh-gateway to Myriad (if you are outside the UCL firewall so can&#x27;t get directly to Myriad):<ul class="bullet"><li>scp -o ProxyJump=ssh-gateway.ucl.ac.uk thing.txt username@myriad.rc.ucl.ac.uk:~</li><li>You will be asked for your password twice, once to log in to ssh-gateway, then again to log in to Myriad</li><li>More info here: <a href="https&#x3a;&#x2F;&#x2F;www&#x2e;rc&#x2e;ucl&#x2e;ac&#x2e;uk&#x2F;docs&#x2F;howto&#x2F;&#x23;single&#x2d;step&#x2d;logins&#x2d;using&#x2d;tunnelling" rel="noreferrer noopener">https:&#x2F;&#x2F;www.rc.ucl.ac.uk&#x2F;docs&#x2F;howto&#x2F;#single-step-logins-using-tunnelling</a></ul></li></ul><li><strong>tar -czvf foldername&#x2F;&nbsp; compressedfoldername.tar.gz</strong> : compress a folder<ul class="bullet"><li>-c means to compress</li><li>-z means make a gzip file</li><li>-v means verbose (print information about files being compressed)</li><li>-f means you will give it the filename</ul><li><strong>rsync</strong> : another way of copying files like scp, but useful if you want to copy more files or only things that have changed, or if you have a bad internet connection.</li><li><strong>date:</strong> prints out the date and time</li><li><strong>lquota </strong>: see how much disk space you are allocated nad how much of that you have used</li><li><strong>top</strong> : show currently running processes</li><li><strong>kill &lt;processID&gt;</strong> : kill a certail process&nbsp;</ul><br><h3>Python program:</h3><br>module unload -f compilers mpi<br>module load compilers&#x2F;gnu&#x2F;4.9.2 mpi&#x2F;openmpi&#x2F;3.1.4&#x2F;gnu-4.9.2 python3&#x2F;3.7 mpi4py&#x2F;3.0.2&#x2F;gnu-4.9.2<br><br><code>import numpy as np</code><br><code>import sys</code><br><code>import datetime</code><br><code></code><br><code>def inside_circle(total_count):</code><br><code>&nbsp;&nbsp;&nbsp; x = np.random.uniform(size=total_count)</code><br><code>&nbsp;&nbsp;&nbsp; y = np.random.uniform(size=total_count)</code><br><code>&nbsp;&nbsp;&nbsp; radii = np.sqrt(x * x + y * y)</code><br><code>&nbsp;&nbsp;&nbsp; count = len(radii[np.where(radii&lt;=1.0)])</code><br><code>&nbsp;&nbsp;&nbsp; return count</code><br><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><br><code>def main():</code><br><code>&nbsp;&nbsp;&nbsp; n_samples = int(sys.argv[1])</code><br><code>&nbsp;&nbsp;&nbsp; start_time = datetime.datetime.now()</code><br><code>&nbsp;&nbsp;&nbsp; counts = inside_circle(n_samples)</code><br><code>&nbsp;&nbsp;&nbsp; end_time = datetime.datetime.now()</code><br><code>&nbsp;&nbsp;&nbsp; elapsed_time = (end_time - start_time).total_seconds()</code><br><code>&nbsp;&nbsp;&nbsp; my_pi = 4.0 * counts &#x2F; n_samples</code><br><code>&nbsp;&nbsp;&nbsp; size_of_float = np.dtype(np.float64).itemsize</code><br><code>&nbsp;&nbsp;&nbsp; memory_required = 3 * n_samples * size_of_float &#x2F; (1024**3)</code><br><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><br><code>&nbsp;&nbsp;&nbsp; print(&quot;Pi: {}, memory: {} GiB, time: {} s&quot;.format(my_pi, memory_required,</code><br><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elapsed_time))</code><br><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><br><code>if __name__ == &#x27;__main__&#x27;:</code><br><code>&nbsp;&nbsp;&nbsp; main()</code><br><br><h3>Bash job script to run the serial example:</h3><br><br>#!&#x2F;bin&#x2F;bash --login<br><br>#$ -N serial_pi<br>#$ -l h_rt=0:15:0<br>#$ -l mem=3G<br>#$ -pe smp 1<br>#$ -cwd<br><br>module unload -f compilers mpi<br>module load compilers&#x2F;gnu&#x2F;4.9.2<br>module load mpi&#x2F;openmpi&#x2F;3.1.4&#x2F;gnu-4.9.2<br>module load python3&#x2F;3.7<br>module load mpi4py&#x2F;3.0.2&#x2F;gnu-4.9.2<br><br>python pi.py 100000000<br><br><br><h4>Python MPI parallel calculation of pi</h4><br><a href="http&#x3a;&#x2F;&#x2F;rits&#x2e;github&#x2d;pages&#x2e;ucl&#x2e;ac&#x2e;uk&#x2F;hpc&#x2d;intro&#x2F;files&#x2F;pi&#x2d;mpi&#x2e;py" rel="noreferrer noopener">http:&#x2F;&#x2F;rits.github-pages.ucl.ac.uk&#x2F;hpc-intro&#x2F;files&#x2F;pi-mpi.py</a><br><br>#!&#x2F;bin&#x2F;bash --login<br><br>#$ -N parallel_pi<br>#$ -l h_rt=0:15:0<br>#$ -l mem=1G<br>#$ -pe mpi 4<br>#$ -cwd<br><br>module unload -f compilers mpi<br>module load compilers&#x2F;gnu&#x2F;4.9.2<br>module load mpi&#x2F;openmpi&#x2F;3.1.4&#x2F;gnu-4.9.2<br>module load python3&#x2F;3.7<br>module load mpi4py&#x2F;3.0.2&#x2F;gnu-4.9.2<br><br># gerun is UCL&#x27;s mpirun wrapper that sets np and a machinefile (if necessary) for you. Only Intel MPI needs a machinefile on our clusters.<br># mpirun -np $NSLOTS -machines=$TMPDIR&#x2F;machines python pi_mpi.py 100000000<br>gerun python pi_mpi.py 100000000<br><br><h2>Exercise</h2><br>You can work through this exercise now and we can help or you can look at it in your own time to practice all the skills we have learned over the last few days.<br><br><a href="https&#x3a;&#x2F;&#x2F;hackmd&#x2e;io&#x2F;&#x40;BvcZAzBNTSazzlAasCy2nw&#x2F;r1hJFrKwd" rel="noreferrer noopener">https:&#x2F;&#x2F;hackmd.io&#x2F;@BvcZAzBNTSazzlAasCy2nw&#x2F;r1hJFrKwd</a><br><br><br><br><h3>Questions and comments</h3><br>Please add any questions or comments here<br><br>Cyberduck (tranferring files to and from Myriad and easily viewing files): <a href="https&#x3a;&#x2F;&#x2F;cyberduck&#x2e;io&#x2F;" rel="noreferrer noopener">https:&#x2F;&#x2F;cyberduck.io&#x2F;</a><br><br>Useful link to make a shortcut to accessing Myriad: <a href="https&#x3a;&#x2F;&#x2F;wiki&#x2e;ucl&#x2e;ac&#x2e;uk&#x2F;pages&#x2F;viewpage&#x2e;action&#x3f;spaceKey&#x3d;bill&amp;title&#x3d;Working&#x2b;with&#x2b;the&#x2b;HPC&#x2b;clusters" rel="noreferrer noopener">https:&#x2F;&#x2F;wiki.ucl.ac.uk&#x2F;pages&#x2F;viewpage.action?spaceKey=bill&amp;title=Working+with+the+HPC+clusters</a><br><ul class="bullet"><li>&nbsp;</li><li>&nbsp;</li></ul><br><h2>Feedback from day 3</h2><br>Please give us some feedback here:<br><br><br>Please let us know&nbsp;<br><ul class="bullet"><li>something that went well today (maybe something you learned that will be very useful to your work)</li><li>something we can improve (maybe something that you found made it more difficult for you to learn, or a command where you got stuck or confused)</ul><br>Press the green plus symbol to add a new note or click on a note to add a +1 to someone else&#x27;s comment.<br><br><h2>Post-workshop survey</h2><br>Please fill in this survey that is similar to the pre-workshop survey in the next day or two so we can evaluate the course and how well we met your requirements.<br><a href="https&#x3a;&#x2F;&#x2F;carpentries&#x2e;typeform&#x2e;com&#x2F;to&#x2F;UgVdRQ&#x3f;slug&#x3d;2022&#x2d;07&#x2d;26&#x2d;UCL&#x2d;HPC&#x2d;online" rel="noreferrer noopener">https:&#x2F;&#x2F;carpentries.typeform.com&#x2F;to&#x2F;UgVdRQ?slug=2022-07-26-UCL-HPC-online</a><br><br>
</body>
</html>
